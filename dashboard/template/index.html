<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Forex Analysis with AI</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* [KEEP ALL YOUR EXISTING CSS STYLES] */
        /* Hanya menambahkan styles baru di bawah ini */
        
        .volatility-display {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .volatility-high { background: #ef4444; color: white; }
        .volatility-medium { background: #f59e0b; color: white; }
        .volatility-low { background: #10b981; color: white; }
        
        .pair-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
        }
        
        .news-sentiment {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
            margin-left: 5px;
        }
        
        .sentiment-positive { background: #10b981; color: white; }
        .sentiment-negative { background: #ef4444; color: white; }
        .sentiment-neutral { background: #6b7280; color: white; }
        
        .enhanced-rec-item {
            background: #334155;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #8b5cf6;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .enhanced-rec-item::after {
            content: '';
            position: absolute;
            top: 5px;
            right: 5px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }
        
        .rec-item.buy-signal { border-left-color: #10b981; }
        .rec-item.sell-signal { border-left-color: #ef4444; }
        .rec-item.hold-signal { border-left-color: #f59e0b; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="ai-badge">Powered by DeepSeek AI</div>
            <h1>ðŸ¤– Enhanced Forex Analysis System</h1>
            <p>Pair-Specific Analysis + Real-time RSS News</p>
            <div class="live-badge">ENHANCED ANALYSIS</div>
        </div>

        <!-- Quick Pairs Overview - Enhanced -->
        <div class="quick-pairs" id="quickPairs">
            <div class="pair-card" onclick="loadPair('GBPJPY')">
                <div>GBP/JPY <span class="volatility-display volatility-high" id="gbpjpyVol">High</span></div>
                <div class="pair-price" id="gbpjpyPrice">-</div>
                <div id="gbpjpyChange">Loading...</div>
            </div>
            <div class="pair-card" onclick="loadPair('USDJPY')">
                <div>USD/JPY <span class="volatility-display volatility-medium" id="usdjpyVol">Med</span></div>
                <div class="pair-price" id="usdjpyPrice">-</div>
                <div id="usdjpyChange">Loading...</div>
            </div>
            <div class="pair-card" onclick="loadPair('EURJPY')">
                <div>EUR/JPY <span class="volatility-display volatility-medium" id="eurjpyVol">Med-High</span></div>
                <div class="pair-price" id="eurjpyPrice">-</div>
                <div id="eurjpyChange">Loading...</div>
            </div>
            <div class="pair-card" onclick="loadPair('CHFJPY')">
                <div>CHF/JPY <span class="volatility-display volatility-low" id="chfjpyVol">Low</span></div>
                <div class="pair-price" id="chfjpyPrice">-</div>
                <div id="chfjpyChange">Loading...</div>
            </div>
        </div>

        <!-- [KEEP ALL YOUR EXISTING HTML STRUCTURE] -->
        <!-- Controls, Loading, Error, Dashboard sections remain the same -->

        <div class="controls">
            <div class="control-group">
                <label>Currency Pair:</label>
                <select id="pairSelect">
                    <option value="GBPJPY">GBP/JPY (High Volatility)</option>
                    <option value="USDJPY">USD/JPY (Medium Volatility)</option>
                    <option value="EURJPY">EUR/JPY (Medium-High Volatility)</option>
                    <option value="CHFJPY">CHF/JPY (Low Volatility)</option>
                    <option value="AUDJPY">AUD/JPY (Medium Volatility)</option>
                    <option value="CADJPY">CAD/JPY (Medium Volatility)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Timeframe:</label>
                <select id="timeframeSelect">
                    <option value="1H">1 Hour</option>
                    <option value="4H">4 Hours</option>
                    <option value="1D">1 Day</option>
                </select>
            </div>

            <div class="control-group">
                <button onclick="getAnalysis()">ðŸ¤– Analyze with AI</button>
                <button onclick="refreshAllData()">ðŸ”„ Refresh All</button>
            </div>
        </div>

        <!-- [REST OF YOUR HTML REMAINS THE SAME] -->
    </div>

    <script>
        // [KEEP ALL YOUR EXISTING JAVASCRIPT]
        // Only adding enhanced functions below
        
        function updateQuickPairs(data) {
            for (const [pair, info] of Object.entries(data)) {
                const priceElement = document.getElementById(pair.toLowerCase() + 'Price');
                const changeElement = document.getElementById(pair.toLowerCase() + 'Change');
                const volElement = document.getElementById(pair.toLowerCase() + 'Vol');
                
                if (priceElement && changeElement && info.price) {
                    priceElement.textContent = info.price;
                    const change = info.change || 0;
                    
                    // Enhanced display with volatility
                    changeElement.innerHTML = `
                        <span style="color: ${change >= 0 ? '#10b981' : '#ef4444'}">
                            ${change >= 0 ? 'â†—' : 'â†˜'} ${Math.abs(change).toFixed(2)}%
                        </span>
                        <br><small>${info.signal} (${info.confidence}%)</small>
                        ${info.volatility ? `<br><small>Vol: ${info.volatility}</small>` : ''}
                    `;
                    
                    // Update volatility display
                    if (volElement && info.volatility) {
                        const vol = parseFloat(info.volatility);
                        if (vol > 0.3) {
                            volElement.className = 'volatility-display volatility-high';
                            volElement.textContent = 'High';
                        } else if (vol > 0.2) {
                            volElement.className = 'volatility-display volatility-medium';
                            volElement.textContent = 'Med';
                        } else {
                            volElement.className = 'volatility-display volatility-low';
                            volElement.textContent = 'Low';
                        }
                    }
                    
                    // Update card style for current pair
                    const card = priceElement.closest('.pair-card');
                    if (pair === currentPair) {
                        card.classList.add('active');
                    } else {
                        card.classList.remove('active');
                    }
                }
            }
        }

        function updateTradingRecommendations(aiAnalysis) {
            // Update trading recommendations
            document.getElementById('signalType').textContent = aiAnalysis.SIGNAL;
            document.getElementById('entryPrice').textContent = aiAnalysis.ENTRY_PRICE;
            document.getElementById('stopLoss').textContent = aiAnalysis.STOP_LOSS;
            document.getElementById('takeProfit1').textContent = aiAnalysis.TAKE_PROFIT_1;
            document.getElementById('takeProfit2').textContent = aiAnalysis.TAKE_PROFIT_2;
            document.getElementById('riskReward').textContent = aiAnalysis.RISK_REWARD_RATIO;
            document.getElementById('timeHorizon').textContent = aiAnalysis.TIME_HORIZON;
            document.getElementById('pipsRisk').textContent = aiAnalysis.PIPS_RISK + ' pips';
            document.getElementById('tradingAdvice').textContent = aiAnalysis.TRADING_ADVICE || 'No specific advice available.';
            
            // Enhanced color coding based on signal
            const signal = aiAnalysis.SIGNAL;
            const recItems = document.querySelectorAll('.rec-item');
            recItems.forEach(item => {
                if (signal.includes('BUY')) {
                    item.classList.add('buy-signal');
                    item.classList.remove('sell-signal', 'hold-signal');
                } else if (signal.includes('SELL')) {
                    item.classList.add('sell-signal');
                    item.classList.remove('buy-signal', 'hold-signal');
                } else {
                    item.classList.add('hold-signal');
                    item.classList.remove('buy-signal', 'sell-signal');
                }
            });
        }

        function updateNews(newsItems) {
            const container = document.getElementById('newsContainer');
            container.innerHTML = '';
            
            if (!newsItems || newsItems.length === 0) {
                container.innerHTML = '<div class="news-item">No market news available</div>';
                return;
            }
            
            newsItems.forEach(news => {
                const newsDiv = document.createElement('div');
                newsDiv.className = 'news-item';
                
                const impactClass = `impact-${news.impact?.toLowerCase() || 'medium'}`;
                const sentimentClass = `sentiment-${news.sentiment || 'neutral'}`;
                
                // Add sentiment indicator
                let sentimentIcon = 'âž–';
                if (news.sentiment === 'positive') sentimentIcon = 'ðŸ“ˆ';
                if (news.sentiment === 'negative') sentimentIcon = 'ðŸ“‰';
                
                newsDiv.innerHTML = `
                    <div class="news-source">
                        ${news.source}
                        <span class="news-impact ${impactClass}">${news.impact || 'MEDIUM'}</span>
                    </div>
                    <div class="news-headline">${sentimentIcon} ${news.headline}</div>
                    <div class="news-timestamp">${news.timestamp} | 
                        Sentiment: <span class="news-sentiment ${sentimentClass}">${news.sentiment || 'neutral'}</span>
                    </div>
                `;
                container.appendChild(newsDiv);
            });
        }

        // Enhanced technical indicators display
        function updateTechnicalIndicators(indicators) {
            const container = document.getElementById('technicalIndicators');
            container.innerHTML = '';
            
            const indicatorConfig = [
                { label: 'RSI', value: indicators.RSI, format: v => v.toFixed(2), 
                  color: v => v > 70 ? '#ef4444' : v < 30 ? '#10b981' : '#f59e0b' },
                { label: 'MACD', value: indicators.MACD, format: v => v.toFixed(4) },
                { label: 'SMA 20', value: indicators.SMA_20, format: v => v.toFixed(4) },
                { label: 'SMA 50', value: indicators.SMA_50, format: v => v.toFixed(4) },
                { label: 'Resistance', value: indicators.Resistance, format: v => v.toFixed(4) },
                { label: 'Support', value: indicators.Support, format: v => v.toFixed(4) },
                { label: 'Volatility', value: indicators.Volatility, format: v => v, 
                  color: v => {
                      const vol = parseFloat(v);
                      return vol > 0.3 ? '#ef4444' : vol > 0.2 ? '#f59e0b' : '#10b981';
                  }}
            ];
            
            indicatorConfig.forEach(ind => {
                const div = document.createElement('div');
                div.className = 'indicator';
                div.innerHTML = `
                    <div class="indicator-value" style="color: ${ind.color ? ind.color(ind.value) : '#60a5fa'}">
                        ${ind.format(ind.value)}
                    </div>
                    <div class="indicator-label">${ind.label}</div>
                `;
                container.appendChild(div);
            });
        }

        // [REST OF YOUR JAVASCRIPT REMAINS THE SAME]
    </script>
</body>
</html>
