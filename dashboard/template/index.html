<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ANDRO-FX Precision Forex Trading</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/lightweight-charts@4.0.0/dist/lightweight-charts.standalone.production.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --deepseek-primary: #0066cc;
      --deepseek-secondary: #00aaff;
      --deepseek-accent: #004499;
      --signal-buy: #10b981;
      --signal-sell: #ef4444;
      --signal-hold: #f59e0b;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --bg-primary: #f8fafc;
      --bg-card: #ffffff;
      --border-radius: 12px;
    }

    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      font-family: "Inter", "Segoe UI", sans-serif;
      padding: 18px;
    }

    .topbar {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      padding: 15px 20px;
      background: var(--bg-card);
      border-radius: var(--border-radius);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .brand-logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      font-size: 1.5rem;
      color: var(--deepseek-primary);
    }

    .brand-logo i {
      color: var(--deepseek-secondary);
    }

    .card-soft {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      padding: 20px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.05);
      margin-bottom: 20px;
      border: 1px solid rgba(0, 0, 0, 0.05);
    }

    .section-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--deepseek-primary);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title i {
      color: var(--deepseek-secondary);
    }

    #chartRoot { 
      height: 520px; 
      border-radius: var(--border-radius); 
      background: var(--bg-card);
    }
    
    #macdRoot { 
      height: 160px; 
      margin-top: 15px; 
      border-radius: var(--border-radius); 
      background: var(--bg-card);
    }

    .muted { 
      color: var(--text-secondary); 
      font-size: 0.95rem; 
    }

    .ai-signal-buy { 
      color: white; 
      background: var(--signal-buy); 
      padding: 8px 16px; 
      border-radius: 8px; 
      font-weight: 700;
      font-size: 1.2rem;
      text-align: center;
      box-shadow: 0 4px 6px rgba(16, 185, 129, 0.3);
    }

    .ai-signal-sell { 
      color: white; 
      background: var(--signal-sell); 
      padding: 8px 16px; 
      border-radius: 8px; 
      font-weight: 700;
      font-size: 1.2rem;
      text-align: center;
      box-shadow: 0 4px 6px rgba(239, 68, 68, 0.3);
    }

    .ai-signal-hold { 
      color: white; 
      background: var(--signal-hold); 
      padding: 8px 16px; 
      border-radius: 8px; 
      font-weight: 700;
      font-size: 1.2rem;
      text-align: center;
      box-shadow: 0 4px 6px rgba(245, 158, 11, 0.3);
    }

    .small-muted { 
      color: var(--text-secondary); 
      font-size: 0.9rem; 
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-live { background-color: var(--signal-buy); }
    .status-offline { background-color: var(--signal-sell); }

    .metric-card {
      background: var(--bg-primary);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 12px;
      border-left: 4px solid var(--deepseek-secondary);
    }

    .metric-value {
      font-size: 1.4rem;
      font-weight: 700;
    }

    .backtest-panel {
      max-height: 400px;
      overflow-y: auto;
    }

    .performance-grade {
      font-size: 1.6rem;
      font-weight: bold;
      text-align: center;
      padding: 12px;
      border-radius: 10px;
      margin: 12px 0;
    }

    .grade-a { background: #d1fae5; color: #065f46; }
    .grade-b { background: #fef3c7; color: #92400e; }
    .grade-c { background: #fde68a; color: #78350f; }
    .grade-d { background: #fecaca; color: #991b1b; }

    .trading-level {
      font-size: 1.1rem;
      font-weight: 600;
      padding: 8px 12px;
      border-radius: 8px;
      margin: 5px 0;
    }

    .level-entry { 
      background: rgba(16, 185, 129, 0.1); 
      color: var(--signal-buy);
      border-left: 4px solid var(--signal-buy);
    }

    .level-sl { 
      background: rgba(239, 68, 68, 0.1); 
      color: var(--signal-sell);
      border-left: 4px solid var(--signal-sell);
    }

    .level-tp { 
      background: rgba(34, 197, 94, 0.1); 
      color: #16a34a;
      border-left: 4px solid #16a34a;
    }

    .btn-deepseek {
      background: var(--deepseek-primary);
      color: white;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
    }

    .btn-deepseek:hover {
      background: var(--deepseek-accent);
      color: white;
    }

    .btn-action {
      background: var(--deepseek-secondary);
      color: white;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
    }

    .btn-action:hover {
      background: var(--deepseek-primary);
      color: white;
    }

    .price-ticker {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--deepseek-primary);
    }

    .price-change {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .change-positive { color: var(--signal-buy); }
    .change-negative { color: var(--signal-sell); }

    .risk-approved { 
      color: var(--signal-buy); 
      font-weight: 700;
      font-size: 1.1rem;
    }

    .risk-rejected { 
      color: var(--signal-sell); 
      font-weight: 700;
      font-size: 1.1rem;
    }

    .tech-indicator {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }

    .indicator-value {
      font-weight: 700;
      font-size: 1.1rem;
    }

    .news-container {
      max-height: 120px;
      overflow-y: auto;
      padding: 10px;
      background: var(--bg-primary);
      border-radius: 8px;
      border-left: 4px solid var(--deepseek-secondary);
    }

    /* Enhanced Trading Styles */
    .timeframe-controls {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .timeframe-btn {
      padding: 6px 12px;
      border: 1px solid var(--deepseek-secondary);
      border-radius: 6px;
      background: transparent;
      color: var(--deepseek-secondary);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .timeframe-btn.active {
      background: var(--deepseek-secondary);
      color: white;
    }

    .data-period-selector {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
    }

    .chart-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .indicator-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
    }

    .price-levels-panel {
      max-height: 300px;
      overflow-y: auto;
      margin-top: 15px;
    }

    .price-level-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      border-radius: 6px;
      margin-bottom: 5px;
      border-left: 4px solid transparent;
    }

    .price-level-support {
      background: rgba(16, 185, 129, 0.05);
      border-left-color: var(--signal-buy);
    }

    .price-level-resistance {
      background: rgba(239, 68, 68, 0.05);
      border-left-color: var(--signal-sell);
    }

    .price-level-pivot {
      background: rgba(79, 70, 229, 0.05);
      border-left-color: #4f46e5;
    }

    .level-strength {
      font-size: 0.8rem;
      padding: 2px 6px;
      border-radius: 4px;
    }

    .strength-strong { background: #fee2e2; color: #dc2626; }
    .strength-medium { background: #fef3c7; color: #d97706; }
    .strength-weak { background: #d1fae5; color: #059669; }

    .analysis-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      border-bottom: 1px solid #e5e7eb;
    }

    .analysis-tab {
      padding: 8px 16px;
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      cursor: pointer;
      font-weight: 500;
    }

    .analysis-tab.active {
      border-bottom-color: var(--deepseek-primary);
      color: var(--deepseek-primary);
    }

    .historical-performance {
      margin-top: 20px;
    }

    .performance-metric {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .performance-bar {
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      margin: 5px 0;
      overflow: hidden;
    }

    .performance-fill {
      height: 100%;
      border-radius: 3px;
    }

    .trend-analysis {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 15px;
    }

    .trend-card {
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }

    .trend-up {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .trend-down {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .trend-neutral {
      background: rgba(245, 158, 11, 0.1);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }
  </style>
</head>
<body>

<div class="topbar">
  <div class="brand-logo">
    <i class="fas fa-brain"></i>
    <span>ANDRO-FX Precision Forex Trading</span>
  </div>
  
  <div class="d-flex flex-wrap gap-3 align-items-center ms-auto">
    <div class="d-flex align-items-center">
      <label class="small-muted mb-0 me-2">Pair</label>
      <select id="pairSelect" class="form-select form-select-sm" style="width:130px;">
        <option>USDJPY</option>
        <option>EURJPY</option>
        <option>GBPJPY</option>
        <option>CHFJPY</option>
        <option>GBPUSD</option>
        <option>USDCHF</option>
        <option>AUDUSD</option>
        <option>USDCAD</option>
        <option>NZDUSD</option>
      </select>
    </div>
    
    <div class="d-flex align-items-center">
      <label class="small-muted mb-0 me-2">Data Period</label>
      <select id="periodSelect" class="form-select form-select-sm" style="width:140px;">
        <option value="1M">1 Month (1H)</option>
        <option value="3M">3 Months (1H/4H)</option>
        <option value="6M" selected>6 Months (4H)</option>
        <option value="1Y">1 Year (1D)</option>
        <option value="2Y">2 Years (1D)</option>
      </select>
    </div>
    
    <button id="analyzeBtn" class="btn btn-deepseek">
      <i class="fas fa-chart-line me-2"></i>Analyze
    </button>
    
    <button id="runBacktestBtn" class="btn btn-action">
      <i class="fas fa-play-circle me-2"></i>Backtest
    </button>
    
    <div id="pairTicker" class="d-flex align-items-center ms-3">
      <span class="price-ticker me-2">USDJPY –</span>
      <span id="livePrice" class="price-ticker">147.3990</span>
      <span id="pairChange" class="price-change change-negative ms-2">(-0.25%)</span>
      <span id="statusIndicator" class="status-indicator status-live ms-2"></span>
    </div>
  </div>
</div>

<div class="row g-4">
  <div class="col-lg-8">
    <div class="card-soft">
      <div class="chart-controls">
        <div>
          <div class="section-title">
            <i class="fas fa-chart-candlestick"></i>
            <span>Live Price Chart</span>
          </div>
          <div class="muted" id="chartSubtitle">Real-time Candlestick · EMA26 · MACD</div>
        </div>
        <div class="text-end">
          <div class="small-muted">Current Price</div>
          <div class="price-ticker" id="currentPrice">147.3990</div>
        </div>
      </div>
      
      <!-- Timeframe Controls -->
      <div class="timeframe-controls">
        <button class="timeframe-btn active" data-tf="1D">1D</button>
        <button class="timeframe-btn" data-tf="4H">4H</button>
        <button class="timeframe-btn" data-tf="1H">1H</button>
        <button class="timeframe-btn" data-tf="30M">30M</button>
        <button class="timeframe-btn" data-tf="15M">15M</button>
        <button class="timeframe-btn" data-tf="5M">5M</button>
      </div>
      
      <!-- Chart Indicators Toggle -->
      <div class="d-flex gap-4 mb-3">
        <div class="indicator-toggle">
          <input type="checkbox" id="toggleEMA" checked>
          <label for="toggleEMA" class="small-muted">EMA (26,50,100)</label>
        </div>
        <div class="indicator-toggle">
          <input type="checkbox" id="toggleBollinger" checked>
          <label for="toggleBollinger" class="small-muted">Bollinger Bands</label>
        </div>
        <div class="indicator-toggle">
          <input type="checkbox" id="toggleVolume" checked>
          <label for="toggleVolume" class="small-muted">Volume</label>
        </div>
      </div>
      
      <div id="chartRoot"></div>
      <div id="macdRoot"></div>
      
      <!-- Price Levels Panel -->
      <div class="price-levels-panel">
        <div class="section-title">
          <i class="fas fa-layer-group"></i>
          <span>Key Price Levels</span>
        </div>
        
        <div class="price-level-item price-level-resistance">
          <div>
            <strong>Resistance 3</strong>
            <div class="small-muted">Strong Resistance</div>
          </div>
          <div class="text-end">
            <div class="fw-bold">149.2540</div>
            <span class="level-strength strength-strong">Strong</span>
          </div>
        </div>
        
        <div class="price-level-item price-level-resistance">
          <div>
            <strong>Resistance 2</strong>
            <div class="small-muted">Stop Loss Level</div>
          </div>
          <div class="text-end">
            <div class="fw-bold">148.1000</div>
            <span class="level-strength strength-medium">Medium</span>
          </div>
        </div>
        
        <div class="price-level-item price-level-resistance">
          <div>
            <strong>Resistance 1</strong>
            <div class="small-muted">Minor Resistance</div>
          </div>
          <div class="text-end">
            <div class="fw-bold">147.8000</div>
            <span class="level-strength strength-weak">Weak</span>
          </div>
        </div>
        
        <div class="price-level-item price-level-pivot">
          <div>
            <strong>Current Price</strong>
            <div class="small-muted">Market Price</div>
          </div>
          <div class="text-end">
            <div class="fw-bold">147.3990</div>
            <span class="level-strength strength-weak">Live</span>
          </div>
        </div>
        
        <div class="price-level-item price-level-support">
          <div>
            <strong>Support 1</strong>
            <div class="small-muted">Take Profit 1</div>
          </div>
          <div class="text-end">
            <div class="fw-bold">146.8000</div>
            <span class="level-strength strength-weak">Weak</span>
          </div>
        </div>
        
        <div class="price-level-item price-level-support">
          <div>
            <strong>Support 2</strong>
            <div class="small-muted">Take Profit 2</div>
          </div>
          <div class="text-end">
            <div class="fw-bold">146.5870</div>
            <span class="level-strength strength-medium">Medium</span>
          </div>
        </div>
        
        <div class="price-level-item price-level-support">
          <div>
            <strong>Support 3</strong>
            <div class="small-muted">Strong Support</div>
          </div>
          <div class="text-end">
            <div class="fw-bold">145.9200</div>
            <span class="level-strength strength-strong">Strong</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Advanced Analysis Tabs -->
    <div class="card-soft">
      <div class="analysis-tabs">
        <button class="analysis-tab active" data-tab="technical">Technical Analysis</button>
        <button class="analysis-tab" data-tab="fundamental">Fundamental Analysis</button>
        <button class="analysis-tab" data-tab="sentiment">Market Sentiment</button>
        <button class="analysis-tab" data-tab="historical">Historical Performance</button>
      </div>
      
      <div id="technicalAnalysis" class="analysis-content">
        <div class="row">
          <div class="col-md-6">
            <div class="section-title">
              <i class="fas fa-chart-line"></i>
              <span>Trend Analysis</span>
            </div>
            
            <div class="trend-analysis">
              <div class="trend-card trend-down">
                <div class="small-muted">Primary Trend</div>
                <div class="fw-bold">Bearish</div>
                <div class="small-muted">4H & 1D Timeframe</div>
              </div>
              <div class="trend-card trend-neutral">
                <div class="small-muted">Secondary Trend</div>
                <div class="fw-bold">Neutral</div>
                <div class="small-muted">1H Timeframe</div>
              </div>
              <div class="trend-card trend-down">
                <div class="small-muted">Momentum</div>
                <div class="fw-bold">Bearish</div>
                <div class="small-muted">RSI & MACD</div>
              </div>
              <div class="trend-card trend-up">
                <div class="small-muted">Volatility</div>
                <div class="fw-bold">Increasing</div>
                <div class="small-muted">ATR Rising</div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="section-title">
              <i class="fas fa-ruler-combined"></i>
              <span>Pattern Recognition</span>
            </div>
            
            <div class="tech-indicator">
              <span class="small-muted">Chart Pattern</span>
              <span class="indicator-value">Descending Triangle</span>
            </div>
            <div class="tech-indicator">
              <span class="small-muted">Fibonacci Level</span>
              <span class="indicator-value">61.8% Retracement</span>
            </div>
            <div class="tech-indicator">
              <span class="small-muted">Support Break</span>
              <span class="indicator-value change-negative">Confirmed</span>
            </div>
            <div class="tech-indicator">
              <span class="small-muted">Volume Trend</span>
              <span class="indicator-value">Below Average</span>
            </div>
          </div>
        </div>
        
        <div class="historical-performance">
          <div class="section-title">
            <i class="fas fa-chart-bar"></i>
            <span>Historical Performance</span>
          </div>
          
          <div class="performance-metric">
            <span class="small-muted">1 Week Performance</span>
            <span class="change-negative">-1.2%</span>
          </div>
          <div class="performance-bar">
            <div class="performance-fill" style="width: 40%; background: #ef4444;"></div>
          </div>
          
          <div class="performance-metric">
            <span class="small-muted">1 Month Performance</span>
            <span class="change-negative">-2.8%</span>
          </div>
          <div class="performance-bar">
            <div class="performance-fill" style="width: 60%; background: #ef4444;"></div>
          </div>
          
          <div class="performance-metric">
            <span class="small-muted">3 Month Performance</span>
            <span class="change-positive">+3.5%</span>
          </div>
          <div class="performance-bar">
            <div class="performance-fill" style="width: 30%; background: #10b981;"></div>
          </div>
          
          <div class="performance-metric">
            <span class="small-muted">1 Year Performance</span>
            <span class="change-positive">+12.3%</span>
          </div>
          <div class="performance-bar">
            <div class="performance-fill" style="width: 70%; background: #10b981;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <!-- AI Trading Signal -->
    <div class="card-soft">
      <div class="section-title">
        <i class="fas fa-robot"></i>
        <span>AI Trading Signal</span>
      </div>
      
      <div id="aiSummary" class="muted mb-3">
        USDJPY menunjukkan momentum bearish dengan MACD masih di bawah garis signal dan RSI netral cenderung lemah. 
        Meskipun volatilitas rendah, kondisi teknikal mendukung penurunan lebih lanjut menuju support 146.5870. 
        Fundamental dengan risiko stabilitas keuangan global dan ketegangan geopolitik dapat mendukung safe-haven JPY.
      </div>
      
      <div class="mb-3">
        <div class="small-muted mb-2">TRADING SIGNAL</div>
        <div id="aiSignalBadge" class="ai-signal-sell">SELL</div>
      </div>
      
      <div class="row mb-3">
        <div class="col-6">
          <div class="metric-card">
            <div class="small-muted">Confidence</div>
            <div class="metric-value" id="aiConfidence">65%</div>
          </div>
        </div>
        <div class="col-6">
          <div class="metric-card">
            <div class="small-muted">Risk Level</div>
            <div class="metric-value" id="aiRisk">MEDIUM</div>
          </div>
        </div>
      </div>
      
      <div class="mb-3">
        <div class="small-muted mb-2">TRADING LEVELS</div>
        <div class="trading-level level-entry">
          <i class="fas fa-sign-in-alt me-2"></i>Entry: <span id="aiEntry">147.300 - 147.500</span>
        </div>
        <div class="trading-level level-sl">
          <i class="fas fa-stop-circle me-2"></i>Stop Loss: <span id="aiSL">148.100</span>
        </div>
        <div class="trading-level level-tp">
          <i class="fas fa-target me-2"></i>Take Profit 1: <span id="aiTP1">146.800</span>
        </div>
        <div class="trading-level level-tp">
          <i class="fas fa-bullseye me-2"></i>Take Profit 2: <span id="aiTP2">146.5870</span>
        </div>
      </div>
      
      <div class="mt-3">
        <div class="small-muted mb-2">POSITION SIZING CALCULATOR</div>
        <div class="mb-2">
          <label class="small-muted">Account Balance ($)</label>
          <input type="number" class="form-control" value="10000">
        </div>
        <div class="mb-2">
          <label class="small-muted">Risk Percentage (%)</label>
          <input type="number" class="form-control" value="2" step="0.1">
        </div>
        <div class="metric-card">
          <div class="small-muted">Recommended Position Size</div>
          <div class="metric-value">0.85 Lots</div>
        </div>
      </div>
    </div>

    <!-- Technical Indicators -->
    <div class="card-soft">
      <div class="section-title">
        <i class="fas fa-chart-bar"></i>
        <span>Technical Indicators</span>
      </div>
      
      <div class="tech-indicator">
        <span class="small-muted">RSI (14)</span>
        <span class="indicator-value" id="rsiVal">42.35</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">MACD Line</span>
        <span class="indicator-value" id="macdVal">-0.0023</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">MACD Signal</span>
        <span class="indicator-value" id="macdSignalVal">-0.0015</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">MACD Histogram</span>
        <span class="indicator-value" id="macdHistVal">-0.0008</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">Stochastic %K</span>
        <span class="indicator-value" id="stochK">35.2</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">Stochastic %D</span>
        <span class="indicator-value" id="stochD">42.1</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">Williams %R</span>
        <span class="indicator-value" id="williamsR">-68.5</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">CCI</span>
        <span class="indicator-value" id="cciVal">-45.3</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">ADX</span>
        <span class="indicator-value" id="adxVal">28.45</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">ATR (14)</span>
        <span class="indicator-value" id="atrVal">0.6540</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">Bollinger Position</span>
        <span class="indicator-value" id="bollingerPos">Lower Band</span>
      </div>
      <div class="tech-indicator">
        <span class="small-muted">Ichimoku Cloud</span>
        <span class="indicator-value change-negative" id="ichimoku">Below Cloud</span>
      </div>
    </div>

    <!-- Risk Management -->
    <div class="card-soft">
      <div class="section-title">
        <i class="fas fa-shield-alt"></i>
        <span>Risk Management</span>
      </div>
      
      <div class="mb-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="small-muted">TRADE APPROVAL STATUS</div>
          <div id="riskScoreBadge" class="badge bg-warning">Score: 6/10</div>
        </div>
        
        <div id="riskStatus" class="text-center p-4 rounded-3 mb-3" style="background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border: 2px solid #bae6fd;">
          <div class="risk-icon mb-2">
            <i class="fas fa-check-circle fa-2x text-success"></i>
          </div>
          <div id="riskMainStatus" class="fw-bold fs-5">APPROVED</div>
          <div id="riskSubStatus" class="small text-muted mt-1">Trade meets risk criteria</div>
        </div>
      </div>

      <div class="mb-4">
        <div class="small-muted mb-2">RISK METRICS</div>
        <div class="tech-indicator">
          <span class="small-muted">Risk/Reward Ratio</span>
          <span class="indicator-value">1:1.8</span>
        </div>
        <div class="tech-indicator">
          <span class="small-muted">Win Probability</span>
          <span class="indicator-value">64%</span>
        </div>
        <div class="tech-indicator">
          <span class="small-muted">Max Drawdown</span>
          <span class="indicator-value change-negative">-2.1%</span>
        </div>
        <div class="tech-indicator">
          <span class="small-muted">Position Score</span>
          <span class="indicator-value">7.2/10</span>
        </div>
      </div>
    </div>

    <!-- Market News & Events -->
    <div class="card-soft">
      <div class="section-title">
        <i class="fas fa-newspaper"></i>
        <span>Market News & Events</span>
      </div>
      <div class="news-container" id="fundamentalNews">
        <div class="fw-bold text-primary">BoJ Maintains Ultra-Loose Policy</div>
        <div class="small-muted mb-2">Bank of Japan keeps interest rates unchanged, yen weakens further against major currencies.</div>
        
        <div class="fw-bold text-primary">US CPI Data Ahead</div>
        <div class="small-muted mb-2">Traders await key inflation data release this week for Fed policy clues.</div>
        
        <div class="fw-bold text-primary">Geopolitical Tensions</div>
        <div class="small-muted">Safe-haven flows supporting JPY amid global uncertainty.</div>
      </div>
    </div>

    <!-- Backtest Results -->
    <div class="card-soft">
      <div class="section-title">
        <i class="fas fa-chart-line"></i>
        <span>Backtest Results</span>
        <span id="backtestStatus" class="badge bg-success ms-2">Completed</span>
      </div>
      <div id="backtestResults" class="backtest-panel">
        <div class="performance-grade grade-b">Performance: B+</div>
        <div class="row">
          <div class="col-6">
            <div class="metric-card">
              <div class="small-muted">Total Trades</div>
              <div class="metric-value">142</div>
            </div>
          </div>
          <div class="col-6">
            <div class="metric-card">
              <div class="small-muted">Win Rate</div>
              <div class="metric-value change-positive">72.5%</div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <div class="metric-card">
              <div class="small-muted">Profit Factor</div>
              <div class="metric-value">1.85</div>
            </div>
          </div>
          <div class="col-6">
            <div class="metric-card">
              <div class="small-muted">Sharpe Ratio</div>
              <div class="metric-value">1.42</div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <div class="metric-card">
              <div class="small-muted">Max Drawdown</div>
              <div class="metric-value change-negative">-8.2%</div>
            </div>
          </div>
          <div class="col-6">
            <div class="metric-card">
              <div class="small-muted">Recovery Factor</div>
              <div class="metric-value">2.1</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Enhanced Chart Data Generation with Historical Data
function generateHistoricalData(timeframe, period) {
  const data = [];
  const now = new Date();
  let basePrice = 147.40;
  let candlesCount = 0;

  // Determine number of candles based on timeframe and period
  switch(period) {
    case '1M': candlesCount = 30 * 24; break; // 1 month of 1H data
    case '3M': candlesCount = 90 * 6; break;  // 3 months of 4H data
    case '6M': candlesCount = 180 * 6; break; // 6 months of 4H data
    case '1Y': candlesCount = 365; break;     // 1 year of 1D data
    case '2Y': candlesCount = 730; break;     // 2 years of 1D data
  }

  for (let i = candlesCount; i >= 0; i--) {
    const date = new Date(now);
    
    // Adjust date based on timeframe
    switch(timeframe) {
      case '1D':
        date.setDate(date.getDate() - i);
        break;
      case '4H':
        date.setHours(date.getHours() - i * 4);
        break;
      case '1H':
        date.setHours(date.getHours() - i);
        break;
      case '30M':
        date.setMinutes(date.getMinutes() - i * 30);
        break;
      case '15M':
        date.setMinutes(date.getMinutes() - i * 15);
        break;
      case '5M':
        date.setMinutes(date.getMinutes() - i * 5);
        break;
    }

    // More realistic price movement simulation
    const volatility = 0.002; // 0.2% volatility
    const change = (Math.random() - 0.5) * 2 * volatility * basePrice;
    const open = basePrice;
    const close = basePrice + change;
    const high = Math.max(open, close) + Math.random() * volatility * basePrice;
    const low = Math.min(open, close) - Math.random() * volatility * basePrice;

    // Update base price for next candle (trend simulation)
    basePrice = close;

    data.push({
      time: date.toISOString().split('T')[0] + (timeframe !== '1D' ? ' ' + date.toTimeString().split(' ')[0] : ''),
      open: open,
      high: high,
      low: low,
      close: close,
      volume: Math.random() * 1000 + 500
    });
  }

  return data;
}

// Initialize Charts with Historical Data
const chart = LightweightCharts.createChart(document.getElementById('chartRoot'), {
  layout: { 
    backgroundColor: '#ffffff', 
    textColor: '#111' 
  },
  grid: {
    vertLines: { color: '#f3f4f6' },
    horzLines: { color: '#f3f4f6' }
  },
  timeScale: {
    borderColor: '#eee',
    timeVisible: true,
    secondsVisible: false
  },
  width: document.getElementById('chartRoot').clientWidth,
  height: 520
});

const candleSeries = chart.addCandlestickSeries({
  upColor: '#16a34a',
  downColor: '#dc2626',
  borderVisible: false,
  wickUpColor: '#16a34a',
  wickDownColor: '#dc2626',
});

// Add EMA indicators
const ema26Series = chart.addLineSeries({
  color: '#3b82f6',
  lineWidth: 1,
  priceScaleId: 'right'
});

const ema50Series = chart.addLineSeries({
  color: '#8b5cf6',
  lineWidth: 1,
  priceScaleId: 'right'
});

const ema100Series = chart.addLineSeries({
  color: '#f59e0b',
  lineWidth: 1,
  priceScaleId: 'right'
});

// MACD Chart
const macdChart = LightweightCharts.createChart(document.getElementById('macdRoot'), {
  layout: { 
    backgroundColor: '#ffffff', 
    textColor: '#111' 
  },
  grid: {
    vertLines: { color: '#f3f4f6' },
    horzLines: { color: '#f3f4f6' }
  },
  timeScale: {
    borderColor: '#eee',
    timeVisible: true,
    secondsVisible: false
  },
  width: document.getElementById('macdRoot').clientWidth,
  height: 160
});

const macdLineSeries = macdChart.addLineSeries({
  color: '#0ea5e9',
  lineWidth: 1
});

const macdSignalSeries = macdChart.addLineSeries({
  color: '#f59e0b',
  lineWidth: 1
});

const macdHistogramSeries = macdChart.addHistogramSeries({
  color: '#a78bfa',
  priceFormat: {
    type: 'volume',
  }
});

// Calculate EMA
function calculateEMA(data, period) {
  const k = 2 / (period + 1);
  const ema = [data[0].close];
  
  for (let i = 1; i < data.length; i++) {
    ema.push(data[i].close * k + ema[i - 1] * (1 - k));
  }
  
  return ema.map((value, index) => ({
    time: data[index].time,
    value: value
  }));
}

// Calculate MACD
function calculateMACD(data) {
  const ema12 = calculateEMA(data, 12);
  const ema26 = calculateEMA(data, 26);
  
  const macdLine = ema12.map((ema, index) => ({
    time: ema.time,
    value: ema.value - ema26[index].value
  }));
  
  const signalLine = calculateEMA(macdLine.map(d => ({close: d.value, time: d.time})), 9);
  const histogram = macdLine.map((macd, index) => ({
    time: macd.time,
    value: macd.value - signalLine[index].value
  }));
  
  return { macdLine, signalLine, histogram };
}

// Load initial chart data
function loadChartData(timeframe = '4H', period = '6M') {
  const historicalData = generateHistoricalData(timeframe, period);
  
  // Set candle data
  candleSeries.setData(historicalData);
  
  // Calculate and set EMA indicators
  const ema26Data = calculateEMA(historicalData, 26);
  const ema50Data = calculateEMA(historicalData, 50);
  const ema100Data = calculateEMA(historicalData, 100);
  
  ema26Series.setData(ema26Data);
  ema50Series.setData(ema50Data);
  ema100Series.setData(ema100Data);
  
  // Calculate and set MACD
  const macdData = calculateMACD(historicalData);
  macdLineSeries.setData(macdData.macdLine);
  macdSignalSeries.setData(macdData.signalLine);
  macdHistogramSeries.setData(macdData.histogram);
  
  // Update chart subtitle
  document.getElementById('chartSubtitle').textContent = 
    `${timeframe} Timeframe · ${period} Period · EMA(26,50,100) · MACD`;
}

// Timeframe button event listeners
document.querySelectorAll('.timeframe-btn').forEach(button => {
  button.addEventListener('click', function() {
    // Remove active class from all buttons
    document.querySelectorAll('.timeframe-btn').forEach(btn => btn.classList.remove('active'));
    
    // Add active class to clicked button
    this.classList.add('active');
    
    // Get selected timeframe and period
    const timeframe = this.getAttribute('data-tf');
    const period = document.getElementById('periodSelect').value;
    
    // Reload chart data
    loadChartData(timeframe, period);
  });
});

// Period selector event listener
document.getElementById('periodSelect').addEventListener('change', function() {
  const timeframe = document.querySelector('.timeframe-btn.active').getAttribute('data-tf');
  const period = this.value;
  loadChartData(timeframe, period);
});

// Analysis tabs functionality
document.querySelectorAll('.analysis-tab').forEach(tab => {
  tab.addEventListener('click', function() {
    // Remove active class from all tabs
    document.querySelectorAll('.analysis-tab').forEach(t => t.classList.remove('active'));
    
    // Add active class to clicked tab
    this.classList.add('active');
    
    // Here you would show/hide different analysis content
    // For now, we'll just log the selected tab
    console.log('Selected analysis tab:', this.getAttribute('data-tab'));
  });
});

// Initialize with default data
loadChartData('4H', '6M');

// Handle window resize
window.addEventListener('resize', () => {
  chart.resize(document.getElementById('chartRoot').clientWidth, 520);
  macdChart.resize(document.getElementById('macdRoot').clientWidth, 160);
});
</script>
</body>
</html>
