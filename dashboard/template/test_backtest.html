<!DOCTYPE html>
<html>
<head>
    <title>Test Backtest</title>
</head>
<body>
    <h1>Test Backtest Generation</h1>
    
    <div>
        <label>Pair:</label>
        <select id="pair">
            <option value="USDJPY">USDJPY</option>
            <option value="GBPJPY">GBPJPY</option>
            <option value="EURJPY">EURJPY</option>
            <option value="CHFJPY">CHFJPY</option>
        </select>
    </div>
    
    <div>
        <label>Timeframe:</label>
        <select id="timeframe">
            <option value="4H">4H</option>
            <option value="1H">1H</option>
            <option value="1D">1D</option>
        </select>
    </div>
    
    <div>
        <label>Days:</label>
        <input type="number" id="days" value="30" min="7" max="90">
    </div>
    
    <button onclick="runTestBacktest()">Run Test Backtest</button>
    
    <div id="result" style="margin-top: 20px; white-space: pre-wrap;"></div>

    <script>
        async function runTestBacktest() {
            const pair = document.getElementById('pair').value;
            const timeframe = document.getElementById('timeframe').value;
            const days = document.getElementById('days').value;
            
            document.getElementById('result').innerHTML = 'Running backtest...';
            
            try {
                const response = await fetch('/api/run_backtest', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        pair: pair,
                        timeframe: timeframe,
                        days: parseInt(days)
                    })
                });
                
                const data = await response.json();
                document.getElementById('result').innerHTML = 
                    `Backtest Result:\n${JSON.stringify(data, null, 2)}`;
                    
                // Refresh performance page after 2 seconds
                setTimeout(() => {
                    window.location.href = '/performance';
                }, 2000);
                    
            } catch (error) {
                document.getElementById('result').innerHTML = `Error: ${error}`;
            }
        }
    </script>
</body>
</html>
